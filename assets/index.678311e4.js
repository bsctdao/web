import{_ as G}from"./index.4395bc4f.js";import{o as J,a as W,s as M,t as U,u as K}from"./walletProvider.c7f3a12f.js";import{N as w,a as Q,b as X,S as ee,E as ae,I as te,f as F,c as se,p as N,d as oe}from"./TenDaoToken__factory.e0e15ac7.js";import{d as ne,a as A,r as re,y as d,z as I,aJ as n,aL as o,aN as r,aG as l,u as a,aM as L,aD as E,C as c,aH as z,b as ue,aY as le,aZ as ie,aO as f,a_ as ce,a$ as de,b0 as _e,b1 as fe,bh as pe,aP as ge,b2 as ve}from"./arco.dcacf5bd.js";import"./vue.a1ec4c08.js";const b=B=>(le("data-v-5ae1ef3e"),B=B(),ie(),B),me={class:"swap-content"},be=b(()=>c("h3",null,"\u80A1\u6743\u5956\u52B1\u6C60",-1)),he={key:0},ye=b(()=>c("a",{target:"_blank",href:"https://t.me/+bR4tznC1dYg5ZmU9"},"\u52A0\u5165\u80A1\u4E1C\u7FA4(\u79C1\u6709\u8BF7\u52FF\u5206\u4EAB)",-1)),we=[ye],ke=b(()=>c("br",null,null,-1)),Ae=b(()=>c("br",null,null,-1)),Ie=r(" \u5168\u90E8\u9886\u53D6 "),Ee=r(" \u8BF7\u8FDE\u63A5\u94B1\u5305 "),Be={key:2},xe={style:{display:"flex"}},De=b(()=>c("br",null,null,-1)),Re=b(()=>c("br",null,null,-1)),Ce=b(()=>c("br",null,null,-1)),Se=r(" \u589E\u52A0\u80A1\u6743 "),Fe=r(" \u6388\u6743 "),Ne=r(" \u8BBE\u7F6E\u63A8\u8350\u4EBA "),Me=r(" \u8BF7\u8FDE\u63A5\u94B1\u5305 "),Ue=r("\u590D\u5236\u63A8\u5E7F\u5730\u5740"),Le=ne({setup(B){const m=A(10);let p,s,C;const e=re({connected:!1,totalStaking:0,totalRewards:0,totalReceive:0,userLength:0,userInfo:{address:"",receives:0,rewards:0,staking:0,share:0,invitation:""},balance:0,price:0,stakingInput:0,approve:!1,loading:!1,zeroAdd:"0x0000000000000000000000000000000000000000"}),g=t=>Math.floor(Number(se(t,9))),h=async()=>{if(s&&p&&C){const t=await p.signer.getAddress(),[u,i,x,_,k,S]=await Promise.all([s.totalStaking(),s.totalRewards(),s.totalReceive(),s.getUserInfo(t),s.getUserLength(),p.balanceOf(t)]);e.userLength=k.toNumber(),e.balance=Math.floor(Number(F(S))),e.totalStaking=g(u),e.totalRewards=g(i),e.totalReceive=g(x),e.userInfo={address:_.addr,receives:g(_.receives),rewards:g(_.rewards),staking:g(_.staking),share:g(_.share),invitation:_.invitation},C.getAmountsOut(N("1"),["0x55d398326f99059ff775485246999027b3197955","0xbb4cdb9cbd36b01bd1cbaebf2de08d9173bc095c",U]).then(([D,R,y])=>{e.price=Math.floor(Number(F(y)))}),p.allowance(t,s.address).then(D=>{const R=Math.floor(Number(F(D)));e.approve=R>=e.balance})}else f.warning("\u94B1\u5305\u672A\u54CD\u5E94.")},$=t=>{console.log(t),h()},T=t=>{console.log(t),h()},j=t=>{console.log(t),h()},P=async()=>{if(s){e.loading=!0;try{const t=Math.floor(e.balance*m.value/100);await(await s.increaseStaking(N(`${t}`),{gasLimit:"1500000"})).wait(),h()}catch(t){f.error(t.error?t.error.data.message:t.message)}e.loading=!1}},V=async()=>{const t=document.location.href+"?addr="+e.userInfo.address,u=document.createElement("input");u.value=t,document.body.appendChild(u),u.select(),document.execCommand("copy"),document.body.removeChild(u),f.success("\u590D\u5236\u6210\u529F.")},O=async()=>{if(s){e.loading=!0;try{await(await s.receiveRewards(oe(`${e.userInfo.receives}`,9))).wait(),h()}catch(t){f.error(t.error?t.error.data.message:t.message)}e.loading=!1}};A(""),A(""),A("");let q=window.location.href.split("?")[1],H=new URLSearchParams("?"+q),v=A(H.get("addr"));const Y=async()=>{if(p&&s&&v&&v.value){e.loading=!0;try{const t=await s.getUserInfo(v.value);g(t.staking)>0?(await(await s.setInvitation(v.value)).wait(),f.success("\u6388\u6743\u5B8C\u6210.")):f.success("\u6388\u6743\u5931\u8D25\u4E0A\u7EA7\u5730\u5740\u6709\u8BEF.")}catch(t){f.error(t.error?t.error.data.message:t.message)}e.loading=!1}},Z=async()=>{if(p&&s){e.loading=!0;try{await(await p.approve(M,N("10000000000000"))).wait(),e.approve=!0,f.success("\u6388\u6743\u5B8C\u6210.")}catch(t){f.error(t.error?t.error.data.message:t.message)}e.loading=!1}};return J(async()=>{s==null||s.removeAllListeners(),s=void 0,e.totalStaking=0,e.totalRewards=0,e.totalReceive=0,e.userInfo={address:"",receives:0,rewards:0,staking:0,share:0,invitation:""},e.connected=!1,console.log("\u65AD\u5F00\u8FDE\u63A5.")}),W(async t=>{s=ee.connect(M,t),p=ae.connect(U,t),C=te.connect(K,t),s.on(s.filters.IncreaseStaking(),$),s.on(s.filters.ArriveFeeRewards(),T),s.on(s.filters.ReceiveReward(),j),e.connected=!0,h()}),(t,u)=>{const i=ce,x=de,_=_e,k=fe,S=pe,D=ge,R=ve;return d(),I("div",me,[n(R,{class:"swap-box"},{title:o(()=>[be]),default:o(()=>[n(x,{title:"",layout:"inline-horizontal",size:"large",column:1},{default:o(()=>[n(i,{label:"\u603B\u80A1\u6743"},{default:o(()=>[r(" $"+l(a(e).totalStaking),1)]),_:1}),n(i,{label:"\u603B\u5956\u52B1"},{default:o(()=>[r(" $"+l(a(e).totalRewards),1)]),_:1}),n(i,{label:"\u5DF2\u9886\u53D6"},{default:o(()=>[r(" $"+l(a(e).totalReceive),1)]),_:1}),n(i,{label:"\u53C2\u4E0E\u4EBA\u6570"},{default:o(()=>[r(l(a(e).userLength),1)]),_:1})]),_:1}),n(_),n(x,{title:"",layout:"inline-horizontal",size:"large",column:1},{default:o(()=>[n(i,{label:"\u6211\u7684\u80A1\u6743"},{default:o(()=>[r(l(a(e).userInfo.staking),1)]),_:1}),a(e).userInfo.staking>100?(d(),I("div",he,we)):L("",!0),n(i,{label:"\u5E72\u80A1\u5360\u6BD4"},{default:o(()=>[r(l(Math.floor(a(e).userInfo.staking/a(e).totalStaking*1e4)/100)+" % ",1)]),_:1}),n(i,{label:"\u5206\u7EA2\u5360\u6BD4"},{default:o(()=>[r(l(Math.floor((a(e).userInfo.staking+a(e).userInfo.receives)/(a(e).totalStaking+a(e).totalRewards)*1e4)/100)+" % ",1)]),_:1}),n(i,{label:"\u5982\u679C\u590D\u5229\u5360\u6BD4"},{default:o(()=>[r(l(Math.floor((a(e).userInfo.staking+a(e).userInfo.receives+a(e).userInfo.rewards)/(a(e).totalStaking+a(e).totalRewards)*1e4)/100)+" % ",1)]),_:1}),n(i,{label:"\u5DF2\u9886\u53D6"},{default:o(()=>[r(" $"+l(a(e).userInfo.rewards),1)]),_:1}),n(i,{label:"\u53EF\u9886\u53D6"},{default:o(()=>[r(" $"+l(a(e).userInfo.receives),1)]),_:1})]),_:1}),ke,Ae,a(e).connected?(d(),E(a(w),{key:0,type:"primary",loading:a(e).loading,disabled:a(e).userInfo.receives<=0,onClick:O},{default:o(()=>[Ie]),_:1},8,["loading","disabled"])):(d(),E(a(w),{key:1,type:"primary",status:"danger",disabled:""},{default:o(()=>[Ee]),_:1})),n(_),a(e).connected?(d(),I("div",Be,[c("div",xe,[n(a(Q),{type:"dashboard","gap-position":"bottom",percentage:m.value},null,8,["percentage"]),n(k,{style:{"margin-left":"20px","margin-top":"15px"},direction:"vertical"},{default:o(()=>[c("span",null," \u589E\u52A0 : "+l(Math.floor(a(e).balance*m.value/100)),1),c("span",null," \u83B7\u5F97 : $ "+l(Math.floor(a(e).balance*m.value/100/a(e).price))+" / \u80A1\u6743\u5E01",1),c("span",null,"\u4F59\u989D : "+l(a(e).balance)+" / TDAO",1)]),_:1})]),De,Re,n(a(X),{value:m.value,"onUpdate:value":u[0]||(u[0]=y=>m.value=y)},null,8,["value"]),Ce,n(k,null,{default:o(()=>[a(e).connected&&a(e).userInfo.invitation!=a(e).zeroAdd?(d(),I(z,{key:0},[a(e).approve?(d(),E(a(w),{key:0,type:"primary",loading:a(e).loading,disabled:m.value<=0||a(e).balance==0,onClick:P},{default:o(()=>[Se]),_:1},8,["loading","disabled"])):(d(),E(a(w),{key:1,type:"primary",loading:a(e).loading,onClick:Z},{default:o(()=>[Fe]),_:1},8,["loading"]))],64)):a(e).userInfo.invitation==a(e).zeroAdd?(d(),I(z,{key:1},[n(k,null,{default:o(()=>[n(S,{style:{width:"auto"},value:a(v),"onUpdate:value":u[1]||(u[1]=y=>ue(v)?v.value=y:v=y),placeholder:"\u8BBE\u7F6E\u63A8\u8350\u4EBA","allow-clear":""},null,8,["value"])]),_:1}),n(a(w),{type:"primary",loading:a(e).loading,onClick:Y},{default:o(()=>[Ne]),_:1},8,["loading"])],64)):(d(),E(a(w),{key:2,type:"primary",status:"danger",disabled:""},{default:o(()=>[Me]),_:1})),n(D,{type:"primary",shape:"round",onClick:V},{default:o(()=>[Ue]),_:1})]),_:1})])):L("",!0)]),_:1})])}}});var Oe=G(Le,[["__scopeId","data-v-5ae1ef3e"]]);export{Oe as default};
